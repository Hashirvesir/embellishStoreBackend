"use strict";(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[3349],{46590:function(Z,y,e){e.r(y),e.d(y,{AuthenticatedApp:function(){return Dt}});var t=e(32735),s=e(19565),C=e(20108),f=e(54770),W={i8:"4.12.6"},A=e(63465),x=e(87933),E=e(72850),h=e(74506),S=e(51968),I=e(15062),r=e(53038),tt=e(9026),et=e(67563),H=e(49372),nt=e(15300),at=e(61450),st=e(1897),B=e(78464),G=e(42889),ot=e(25390),lt=e(64838),rt=e(9371),it=e(73165),ct=e(92967),dt=e(60216),O=e.n(dt),mt=e(67879),T=e(14911),V=e(8471);const ut=(0,V.ZP)(E.x)`
  width: ${150/16}rem;
  position: absolute;
  bottom: ${({theme:n})=>n.spaces[9]};
  left: ${({theme:n})=>n.spaces[5]};
`,Y=(0,V.ZP)(T.OL)`
  display: flex;
  justify-content: space-between;
  align-items: center;
  text-decoration: none;
  padding: ${({theme:n})=>`${n.spaces[2]} ${n.spaces[4]}`};
  border-radius: ${({theme:n})=>n.spaces[1]};

  &:hover {
    background: ${({theme:n,logout:l})=>l?n.colors.danger100:n.colors.primary100};
    text-decoration: none;
  }

  svg {
    path {
      fill: ${({theme:n})=>n.colors.danger600};
    }
  }
`,J=({generalSectionLinks:n,pluginsSectionLinks:l})=>{const i=(0,t.useRef)(),[m,d]=(0,t.useState)(!1),{logos:{menu:u}}=(0,A.um)(),[g,P]=(0,s.Yw)("navbar-condensed",!1),{userDisplayName:L}=(0,s.L7)(),{formatMessage:o}=(0,mt.Z)(),{trackUsage:p}=(0,s.rS)(),{pathname:R}=(0,r.TH)(),U=(0,r.k6)(),{post:j}=(0,s.tg)(),D=L.split(" ").map(a=>a.substring(0,1)).join("").substring(0,2),M=()=>d(a=>!a),z=async()=>{await j("/admin/logout"),s.I8.clearAppStorage(),M(),U.push("/auth/login")},$=a=>{!a.currentTarget.contains(a.relatedTarget)&&a.relatedTarget?.parentElement?.id!=="main-nav-user-button"&&d(!1)},v=(a=null)=>{p("willNavigate",{from:R,to:a})},K=o({id:"app.components.LeftMenu.navbrand.title",defaultMessage:"Strapi Dashboard"});return t.createElement(nt.$,{condensed:g},t.createElement(at.D,{as:T.OL,workplace:o({id:"app.components.LeftMenu.navbrand.workplace",defaultMessage:"Workplace"}),title:K,icon:t.createElement("img",{src:u.custom||u.default,alt:o({id:"app.components.LeftMenu.logo.alt",defaultMessage:"Application logo"})})}),t.createElement(tt.i,null),t.createElement(st._,null,t.createElement(B.O,{as:T.OL,to:"/content-manager",icon:t.createElement(it.Z,null),onClick:()=>v("/content-manager")},o({id:"global.content-manager",defaultMessage:"Content manager"})),l.length>0?t.createElement(G.y,{label:o({id:"app.components.LeftMenu.plugins",defaultMessage:"Plugins"})},l.map(a=>{const c=a.icon;return t.createElement(B.O,{as:T.OL,to:a.to,key:a.to,icon:t.createElement(c,null),onClick:()=>v(a.to)},o(a.intlLabel))})):null,n.length>0?t.createElement(G.y,{label:o({id:"app.components.LeftMenu.general",defaultMessage:"General"})},n.map(a=>{const c=a.icon;return t.createElement(B.O,{as:T.OL,badgeContent:a.notificationsCount>0&&a.notificationsCount.toString()||void 0,to:a.to,key:a.to,icon:t.createElement(c,null),onClick:()=>v(a.to)},o(a.intlLabel))})):null),t.createElement(ot.q,null,t.createElement(lt.r,{id:"main-nav-user-button",ref:i,onClick:M,initials:D},L),m&&t.createElement(ut,{onBlur:$,padding:1,shadow:"tableShadow",background:"neutral0",hasRadius:!0},t.createElement(et.i,{onEscape:M},t.createElement(x.k,{direction:"column",alignItems:"stretch",gap:0},t.createElement(Y,{tabIndex:0,onClick:M,to:"/me"},t.createElement(H.Z,null,o({id:"global.profile",defaultMessage:"Profile"}))),t.createElement(Y,{tabIndex:0,onClick:z,to:"/auth/login"},t.createElement(H.Z,{textColor:"danger600"},o({id:"app.components.LeftMenu.logout",defaultMessage:"Logout"})),t.createElement(ct.Z,null))))),t.createElement(rt.w,{onClick:()=>P(a=>!a)},o(g?{id:"app.components.LeftMenu.expand",defaultMessage:"Expand the navbar"}:{id:"app.components.LeftMenu.collapse",defaultMessage:"Collapse the navbar"}))))};J.propTypes={generalSectionLinks:O().array.isRequired,pluginsSectionLinks:O().array.isRequired};var gt=J,pt=e(47446),ft=e(93051),Et=e(63602),ht=e(4556);const vt=t.lazy(()=>Promise.all([e.e(7826),e.e(2747),e.e(4546),e.e(994)]).then(e.bind(e,2046)).then(n=>({default:n.ContentManger}))),yt=t.lazy(()=>e.e(891).then(e.bind(e,38438)).then(n=>({default:n.GuidedTourModal}))),Pt=t.lazy(()=>e.e(3981).then(e.bind(e,83555)).then(n=>({default:n.HomePage}))),Lt=t.lazy(()=>e.e(3677).then(e.bind(e,91534)).then(n=>({default:n.PluginsPage}))),Mt=t.lazy(()=>e.e(5516).then(e.bind(e,95018))),Ct=t.lazy(()=>e.e(6033).then(e.bind(e,51661)).then(n=>({default:n.Onboarding}))),At=t.lazy(()=>e.e(9497).then(e.bind(e,94987)).then(n=>({default:n.ProfilePage}))),Q=t.lazy(()=>e.e(5895).then(e.bind(e,87211)).then(n=>({default:n.SettingsPage}))),St=()=>{const{isLoading:n,generalSectionLinks:l,pluginsSectionLinks:i}=(0,ft.Z)(),{menu:m}=(0,s.j1)(),{showTutorials:d}=(0,pt.Z)(),{trackUsage:u}=(0,s.rS)(),g=(0,I.I0)(),P=(0,I.v9)(o=>o.admin_app.status);t.useEffect(()=>{P==="init"&&(u("didAccessAuthenticatedAdministration"),g({type:ht.eb}))},[P,g,u]);const L=m.filter(o=>o.Component).map(({to:o,Component:p,exact:R})=>(0,Et.o)(p,o,R));return n?t.createElement(s.dO,null):t.createElement(h.DndProvider,{backend:S.PD},t.createElement(x.k,{alignItems:"stretch"},t.createElement(gt,{generalSectionLinks:l,pluginsSectionLinks:i}),t.createElement(E.x,{flex:"1"},t.createElement(t.Suspense,{fallback:t.createElement(s.dO,null)},t.createElement(r.rs,null,t.createElement(r.AW,{path:"/",component:Pt,exact:!0}),t.createElement(r.AW,{path:"/me",component:At,exact:!0}),t.createElement(r.AW,{path:"/content-manager",component:vt}),L,t.createElement(r.AW,{path:"/settings/:settingId",component:Q}),t.createElement(r.AW,{path:"/settings",component:Q,exact:!0}),t.createElement(r.AW,{path:"/marketplace",component:Mt}),t.createElement(r.AW,{path:"/list-plugins",component:Lt,exact:!0})))),t.createElement(yt,null),d&&t.createElement(Ct,null)))};var It=e(35663);const Ot={bufferToHex(n){return[...new Uint8Array(n)].map(l=>l.toString(16).padStart(2,"0")).join("")},async digestMessage(n){const l=new TextEncoder().encode(n),i=await crypto.subtle.digest("SHA-256",l);return this.bufferToHex(i)}};async function Tt(n){return Ot.digestMessage(n.email)}var X=e(82702);const Rt=()=>({type:X.l}),Ut=n=>({type:X.m,permissions:n}),b=({children:n,permissions:l,refetchPermissions:i})=>{const{allPermissions:m}=(0,I.v9)(u=>u.rbacProvider),d=(0,I.I0)();return(0,t.useEffect)(()=>(d(Ut(l)),()=>{d(Rt())}),[l,d]),m?t.createElement(s.oL.Provider,{value:{allPermissions:m,refetchPermissions:i}},n):t.createElement(s.dO,null)};b.propTypes={children:O().element.isRequired,permissions:O().array.isRequired,refetchPermissions:O().func.isRequired};var xt=b;const F=W.i8,k=(n,l)=>!(0,f.valid)(n)||!(0,f.valid)(l)?!1:(0,f.lt)(n,l),Dt=()=>{const{setGuidedTourVisibility:n}=(0,s.c1)(),l=(0,s.lm)(),i=s.I8.getUserInfo(),{get:m}=(0,s.kY)(),[d,u]=t.useState(i?.userName??(0,It.P)(i.firstname,i.lastname)),[g,P]=t.useState(null),{showReleaseNotification:L}=(0,A.um)(),{plugins:o={}}=(0,s.j1)(),[p,R]=t.useState(o),[{data:U,isLoading:j},{data:D},{data:M,isLoading:z,refetch:$},{data:v}]=(0,C.useQueries)([{queryKey:"information",async queryFn(){const{data:{data:a}}=await m("/admin/information");return a}},{queryKey:"strapi-release",async queryFn(){const a=await fetch("https://api.github.com/repos/strapi/strapi/releases/latest");if(!a.ok)throw new Error("Failed to fetch latest Strapi version.");const{tag_name:c}=await a.json();return c},enabled:L,initialData:F,onSuccess(a){k(F,a.tag_name)&&!JSON.parse(localStorage.getItem("STRAPI_UPDATE_NOTIF"))&&l({type:"info",message:{id:"notification.version.update.message"},link:{url:`https://github.com/strapi/strapi/releases/tag/${a.tag_name}`,label:{id:"global.see-more"}},blockTransition:!0,onClose:()=>localStorage.setItem("STRAPI_UPDATE_NOTIF",!0)})},retry:!1},{queryKey:["users","me","permissions"],async queryFn(){const{data:{data:a}}=await m("/admin/users/me/permissions");return a},initialData:[]},{queryKey:["users","me"],async queryFn(){const{data:{data:{roles:a}}}=await m("/admin/users/me");return a}}]);t.useEffect(()=>{v&&v.find(({code:c})=>c==="strapi-super-admin")&&U?.currentEnvironment==="development"&&n(!0)},[v,U,n]),t.useEffect(()=>{i&&(async c=>{const N=await Tt(c);P(N)})(i)},[i]);const K=Object.values(p).some(a=>a.isReady===!1);if(!d||!g||j||z||K){const a=Object.keys(p).reduce((c,N)=>{const w=p[N].initializer;if(w){const Nt=p[N].pluginId;c.push(t.createElement(w,{key:Nt,setPlugin:q=>{R(_=>({..._,[q]:{..._[q],isReady:!0}}))}}))}return c},[]);return t.createElement(t.Fragment,null,a,t.createElement(s.dO,null))}return t.createElement(s.iq,{...U,userId:g,latestStrapiReleaseTag:D,setUserDisplayName:u,shouldUpdateStrapi:k(F,D),userDisplayName:d},t.createElement(xt,{permissions:M,refetchPermissions:$},t.createElement(St,null)))}},63602:function(Z,y,e){e.d(y,{o:function(){return x}});var t=e(32735),s=e(19565),C=e(60216),f=e.n(C),W=e(53038);const A=({loadComponent:E})=>{const[h,S]=(0,t.useState)(null);return(0,t.useEffect)(()=>{(async()=>{try{const r=await E();S(()=>r.default)}catch(r){console.log(r)}})()},[E]),h?t.createElement(h,null):t.createElement(s.dO,null)};A.propTypes={loadComponent:f().func.isRequired};const x=(E,h,S)=>t.createElement(W.AW,{render:()=>t.createElement(A,{loadComponent:E}),key:h,path:h,exact:S||!1})},35663:function(Z,y,e){e.d(y,{P:function(){return t}});const t=(s,C="")=>[s,C].filter(f=>f).join(" ")}}]);
