"use strict";(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[4546],{17379:function(W,v,n){n.d(v,{r:function(){return P}});var m=n(32735),E=n(72850),C=n(60216),I=n.n(C),K=n(74506);function x(M,O,h){if(!M||!O)return{display:"none"};const{x:A,y:U}=h;return{transform:`translate(${A}px, ${U}px)`}}function P({renderItem:M}){const{itemType:O,isDragging:h,item:A,initialOffset:U,currentOffset:Z,mouseOffset:Y}=(0,K.useDragLayer)(L=>({item:L.getItem(),itemType:L.getItemType(),initialOffset:L.getInitialSourceClientOffset(),currentOffset:L.getSourceClientOffset(),isDragging:L.isDragging(),mouseOffset:L.getClientOffset()}));return h?m.createElement(E.x,{height:"100%",left:0,position:"fixed",pointerEvents:"none",top:0,zIndex:100,width:"100%"},m.createElement(E.x,{style:x(U,Z,Y)},M({type:O,item:A}))):null}P.propTypes={renderItem:I().func.isRequired}},75430:function(W,v,n){var m=n(32735);const E=(0,m.createContext)();var C=null},69242:function(W,v,n){n.d(v,{PL:function(){return K},Y9:function(){return x.Y},zE:function(){return ae},Ky:function(){return X},fi:function(){return re},zH:function(){return de},r5:function(){return o}});var m=n(32735),E=n(15062),C=n(53634),K=()=>{const e=(0,E.v9)(C.Z),r=(0,m.useCallback)(t=>e?.components?.[t]??{},[e]);return{...e,getComponentLayout:r}},x=n(77622),P=n(19565),M=n(84306),O=n(20716),h=n(97889);const A={error:null,isLoading:!0,layout:{},layouts:{}};var Z=(e,r)=>(0,h.ZP)(e,t=>{switch(r.type){case"GET_DATA":{t.isLoading=!0,t.error=null,t.layout={};break}case"GET_DATA_SUCCEEDED":{const i=r.data.contentType.uid;t.layout=r.data,t.layouts[i]=r.data,t.isLoading=!1;break}case"GET_DATA_ERROR":{t.isLoading=!1,t.error=r.error;break}case"SET_LAYOUT_FROM_STATE":{t.error=null,t.layout=e.layouts[r.uid];break}case"UPDATE_LAYOUT":{const i=e.layout;t.layout={...i,contentType:{uid:i.contentType.uid,...r.newLayout.contentType}},t.layouts[i.contentType.uid]={...i,contentType:{uid:i.contentType.uid,...r.newLayout.contentType}};break}default:return t}}),Y=n(99381),L=n.n(Y),q=n(33795),R=n.n(q),oe=n(3040),S=n.n(oe),_=n(69997);const Q=(e,r)=>r.find(t=>t.uid===e),ie=(e,r)=>{const t=ee(e,r),i=k(t.contentType,r),f=te(t.contentType,t.components);return S()(t,["contentType","layouts","edit"],i),S()(t,["contentType","layouts","list"],f),Object.keys(t.components).forEach(l=>{const p=k(t.components[l],r);S()(t,["components",l,"layouts","edit"],p)}),t},ee=(e,r)=>{const t=(0,_.w8)(L()(e),r,"contentType"),{components:i,contentType:f}=t,l=p=>Object.keys(p.metadatas).reduce((y,b)=>{const N=R()(p,["attributes",b],{});let F=p.metadatas[b];if(N.type==="relation"){const ye=Q(N.targetModel,r),j=F.edit.mainField,G={name:j,schema:R()(ye,["attributes",j])};F={list:{...F.list,mainField:G},edit:{...F.edit,mainField:G}}}return y[b]=F,y},{});return S()(t,["contentType","metadatas"],l(f)),Object.keys(i).forEach(p=>{const y=i[p],b=l(y);S()(t,["components",p,"metadatas"],b)}),t},k=(e,r)=>e.layouts.edit.reduce((t,i)=>{const f=i.map(l=>{const p=R()(e,["attributes",l.name],{}),y={...l,fieldSchema:p,metadatas:R()(e,["metadatas",l.name,"edit"],{})};if(p.type==="relation"){const N=Q(p.targetModel,r).pluginOptions||{};S()(y,"targetModelPluginOptions",N),S()(y,"queryInfos",{shouldDisplayRelationLink:V(e,l.name,r)})}return y});return t.push(f),t},[]),te=(e,r)=>e.layouts.list.reduce((i,f)=>{const l=R()(e,["attributes",f],{}),p=R()(e,["metadatas",f,"list"],{}),y=l.type;if(y==="relation")return i.push({key:`__${f}_key__`,name:f,fieldSchema:l,metadatas:p}),i;if(y==="component"){const b=r[l.component],N=b.settings.mainField,F=b.attributes[N];return i.push({key:`__${f}_key__`,name:f,fieldSchema:l,metadatas:{...p,mainField:{...F,name:N}}}),i}return i.push({key:`__${f}_key__`,name:f,fieldSchema:l,metadatas:p}),i},[]),V=(e,r,t)=>{const i=R()(e,["attributes",r,"targetModel"],"");return B(t).includes(i)},B=e=>e.filter(r=>r.isDisplayed).map(({uid:r})=>r);var z=ie,ae=e=>{const[{error:r,isLoading:t,layout:i,layouts:f},l]=(0,m.useReducer)(Z,A),p=(0,m.useMemo)(O.Vo,[]),{schemas:y}=(0,E.v9)(j=>p(j),E.wU),b=(0,m.useRef)(!0),{get:N}=(0,P.kY)(),F=(0,m.useCallback)(async(j,G)=>{if(f[j]){l({type:"SET_LAYOUT_FROM_STATE",uid:j});return}l({type:"GET_DATA"});try{const{data:{data:se}}=await N(`/content-manager/content-types/${j}/configuration`,{cancelToken:G.token});l({type:"GET_DATA_SUCCEEDED",data:z(se,y)})}catch(se){if(M.default.isCancel(se))return;b.current&&console.error(se),b.current&&l({type:"GET_DATA_ERROR",error:se})}},[f,y,N]);(0,m.useEffect)(()=>()=>{b.current=!1},[]),(0,m.useEffect)(()=>{const G=M.default.CancelToken.source();return F(e,G),()=>{G.cancel("Operation canceled by the user.")}},[e,F]);const ye=(0,m.useCallback)(j=>{l({type:"UPDATE_LAYOUT",newLayout:z(j,y)})},[y]);return{error:r,isLoading:t,layout:i,updateLayout:ye}},ge=e=>e["content-manager_app"].collectionTypeLinks,ce=n(85973),T=n.n(ce),H=n(33348);const ue=(e,r)=>Object.keys(e).reduce((t,i)=>{const f=e[i],l=R()(r,[i],f);return T()(f)?{...t,[i]:ue(f,l)}:(t[i]=l,t)},{});var le=(e,r,t)=>{const i=e.find(({to:F})=>F.includes(r));if(!i)return"/";const{to:f,search:l}=i,p=(0,H.parse)(l),y=(0,H.parse)(t.substring(1)),b=ue(p,y);return`${f}?${(0,H.stringify)(b,{encode:!1})}`},X=e=>{const[{rawQuery:r}]=(0,P.Kx)(),t=(0,E.v9)(ge);return le(t,e,r)},Te=n(15655),$=n(53038),re=()=>{const{search:e}=(0,$.TH)(),r=e?(0,H.parse)(e.substring(1)):{};return r.plugins?(0,H.stringify)({plugins:r.plugins},{encode:!1}):""};const de=e=>{const r=(0,m.useRef)();return(0,m.useEffect)(()=>{r.current=e},[e]),r.current};var J=n(85149);const fe=(e,r,t)=>({type:J.m,permissions:e,__meta__:{plugins:r,containerName:t}}),me=()=>({type:J.Q}),s=e=>e["content-manager_rbacManager"].permissions,u=e=>e.rbacProvider.collectionTypesRelatedPermissions;var o=(e,r,t="listView")=>{const i=(0,E.I0)(),f=(0,E.v9)(u),l=(0,E.v9)(s),p=f[r];(0,m.useEffect)(()=>p?(i(fe(p,e?e.plugins:null,t)),()=>{i(me())}):()=>{},[p,i,e,t]);const y=l?.some(b=>b.subject!==r)??!0;return{isValid:l&&!y,permissions:l}},d=n(75430);const g=()=>useContext(WysiwygContext);var c=null},77622:function(W,v,n){n.d(v,{Y:function(){return K}});var m=n(32735),E=n(74506),C=n.n(E),I=n(15655);const K=(x,{type:P="STRAPI_DND",index:M,item:O={},onStart:h,onEnd:A,onGrabItem:U,onDropItem:Z,onCancel:Y,onMoveItem:L,dropSensitivity:q="regular"})=>{const R=(0,m.useRef)(null),[{handlerId:oe},S]=(0,E.useDrop)({accept:P,collect(k){return{handlerId:k.getHandlerId()}},hover(k,te){if(!R.current)return;const V=k.index,B=M;if(V!==B){if(q==="regular"){const z=R.current.getBoundingClientRect(),ne=(z.bottom-z.top)/2,w=te.getClientOffset().y-z.top;if(V<B&&w<ne||V>B&&w>ne)return}L(B,V),k.index=B}}}),[{isDragging:_},Q,ie]=(0,E.useDrag)({type:P,item(){h&&h();const{width:k}=R.current?.getBoundingClientRect()??{};return{index:M,width:k,...O}},end(){A&&A()},canDrag:x,isDragging:O.id?k=>O.id===k.getItem().id:void 0,collect:k=>({isDragging:k.isDragging()})}),ee=(0,I.A)(x,M,{onGrabItem:U,onDropItem:Z,onCancel:Y,onMoveItem:L});return[{handlerId:oe,isDragging:_,handleKeyDown:ee},R,S,Q,ie]}},15655:function(W,v,n){n.d(v,{A:function(){return E}});var m=n(32735);const E=(C,I,{onCancel:K,onDropItem:x,onGrabItem:P,onMoveItem:M})=>{const[O,h]=(0,m.useState)(!1),A=L=>{O&&(L==="UP"?M(I-1,I):L==="DOWN"&&M(I+1,I))},U=()=>{O?(x&&x(I),h(!1)):(P&&P(I),h(!0))},Z=()=>{O&&(h(!1),K&&K(I))};return L=>{if(C&&!(L.key==="Tab"&&!O))switch(L.preventDefault(),L.key){case" ":case"Enter":U();break;case"Escape":Z();break;case"ArrowDown":case"ArrowRight":A("DOWN");break;case"ArrowUp":case"ArrowLeft":A("UP");break;default:}}}},20716:function(W,v,n){n.d(v,{Jg:function(){return M},KQ:function(){return x},Vo:function(){return P},Yg:function(){return C}});var m=n(98178),E=n(60371);const C=()=>h=>h["content-manager_app"]||E.E,I=()=>createSelector(C(),h=>h),K=()=>createSelector(C(),h=>h.models),x=()=>(0,m.P1)(C(),h=>({collectionTypeLinks:h.collectionTypeLinks,singleTypeLinks:h.singleTypeLinks})),P=()=>(0,m.P1)(C(),({components:h,models:A})=>({schemas:[...h,...A]})),M=(0,m.P1)(C(),h=>h.fieldSizes);var O=null},53634:function(W,v){const n=m=>m["content-manager_editViewLayoutManager"].currentLayout;v.Z=n},24381:function(W,v){v.Z={COMPONENT:"component",EDIT_FIELD:"editField",FIELD:"field",DYNAMIC_ZONE:"dynamicZone",RELATION:"relation"}},7921:function(W,v){const n=m=>`content-manager.${m}`;v.Z=n},69997:function(W,v,n){n.d(v,{_Q:function(){return B.Z},W3:function(){return I},ko:function(){return x},FE:function(){return M},Di:function(){return U},Ex:function(){return me},du:function(){return q},TA:function(){return S},Ts:function(){return ee},Uo:function(){return te},OB:function(){return V.Z},w8:function(){return ce},kc:function(){return ue}});var m=n(99381),E=n.n(m),I=(s,u,a)=>{if(Array.isArray(s)&&u>=0&&a>=0&&u<=s.length-1&&a<=s.length-1){const o=E()(s),d=o.splice(u,1);return o.splice(a,0,d[0]),o}return s},x=s=>{const{type:u}=s;return u==="relation"?!(s?.relationType??"").toLowerCase().includes("morph"):!["json","dynamiczone","richtext","password"].includes(u)&&!!u};const P=(s,u)=>{typeof s=="function"?s(u):s!=null&&(s.current=u)},M=(...s)=>u=>s.forEach(a=>P(a,u));var O=n(33795),h=n.n(O);const A=(s,u)=>Object.keys(s).reduce((a,o)=>{const d=h()(s,[o],{}),{default:g,component:c,type:e,required:r,min:t,repeatable:i}=d;if(g!==void 0&&(a[o]=g),e==="component"){const f=u?.[c]?.attributes??{},l=A(f,u);if(r===!0&&(a[o]=i===!0?[]:l),t&&i===!0&&r){a[o]=[];for(let p=0;p<t;p+=1)a[o].push(l)}}return e==="dynamiczone"&&r===!0&&(a[o]=[]),a},{});var U=A,Z=n(9086),Y=n.n(Z),q=({layouts:s,metadatas:u,...a})=>{const o=s.list.map(c=>c.name?c.name:c),d=Object.keys(u).reduce((c,e)=>{const r=h()(u,[e],{});let t=r.edit;return t.mainField&&(t={...t,mainField:r.edit.mainField.name}),{...c,[e]:{edit:t,list:Y()(r.list,["mainField"])}}},{}),g=s.edit.map(c=>c.map(({name:e,size:r})=>({name:e,size:r})));return{...a,layouts:{edit:g,list:o},metadatas:d}};const R=(s,u)=>s.map(a=>({...a,subject:u}));var S=s=>{const u={create:[{action:"plugin::content-manager.explorer.create",subject:null}],delete:[{action:"plugin::content-manager.explorer.delete",subject:null}],publish:[{action:"plugin::content-manager.explorer.publish",subject:null}],read:[{action:"plugin::content-manager.explorer.read",subject:null}],update:[{action:"plugin::content-manager.explorer.update",subject:null}]};return Object.keys(u).reduce((a,o)=>(a[o]=R(u[o],s),a),{})},_=n(95919),Q=n.n(_),ee=s=>s.split(".").filter(u=>Q()(parseInt(u,10))),te=s=>{if(s.length===0)return-1;const u=Math.max.apply(Math,s.map(a=>a.__temp_key__??0));return Number.isNaN(u)?-1:u},V=n(7921),B=n(24381),z=n(86349),ne=n.n(z),ae=n(3040),w=n.n(ae),ce=(s,u,a)=>{const o=e=>u.find(r=>r.uid===e),d=Object.assign({},s),g=s[a].uid,c=o(g);return w()(d,[a],ne()({},c,s[a])),Object.keys(s.components).forEach(e=>{const r=o(e);w()(d,["components",e],{...s.components[e],...r})}),d},T=n(19565),ue=(s,u,a)=>{const o=(d,g)=>Object.keys(d).reduce((c,e)=>{const r=(0,T.UN)(g,e),t=h()(d,e),i=(0,T.k2)(g,[e,"component"]),f=(0,T.k2)(g,[e,"repeatable"]);return r==="dynamiczone"?(c[e]=t.map(l=>o(l,a[l.__component])),c):r==="component"?(f?c[e]=t&&t.map(l=>o(l,a[i])):c[e]=t&&o(t,a[i]),c):(r!=="password"&&(c[e]=t),c)},{});return o(s,u)},pe=n(51355),le=n.n(pe),he=n(86834),X=n.n(he),Te=n(78746),$=n.n(Te),D=n(24346),re=n(73347);D.kM(D.nK,"defined",function(){return this.test("defined",T.I0.required,s=>s!==void 0)}),D.kM(D.IX,"notEmptyMin",function(s){return this.test("notEmptyMin",T.I0.min,u=>X()(u)?!0:u.length>=s)}),D.kM(D.Z_,"isInferior",function(s,u){return this.test("isInferior",s,function(a){return!a||Number.isNaN($()(a))?!0:$()(u)>=$()(a)})}),D.kM(D.Z_,"isSuperior",function(s,u){return this.test("isSuperior",s,function(a){return!a||Number.isNaN($()(a))?!0:$()(a)>=$()(u)})});const de=s=>h()(s,["attributes"],{}),J=(s,{components:u},a={isCreatingEntry:!0,isDraft:!0,isFromComponent:!1})=>{const o=de(s);return D.Ry().shape(Object.keys(o).reduce((d,g)=>{const c=o[g];if(c.type!=="relation"&&c.type!=="component"&&c.type!=="dynamiczone"){const e=fe(c.type,c,a);d[g]=e}if(c.type==="relation"&&(d[g]=["oneWay","oneToOne","manyToOne","oneToManyMorph","oneToOneMorph"].includes(c.relationType)?D.Ry().nullable():D.IX().nullable()),c.type==="component"){const e=J(u[c.component],{components:u},{...a,isFromComponent:!0});if(c.repeatable===!0){const{min:t,max:i,required:f}=c;let l=D.Vo(p=>{let y=D.IX().of(e);return t?f?y=y.min(t,T.I0.min):f!==!0&&X()(p)?y=y.nullable():y=y.min(t,T.I0.min):f&&!a.isDraft&&(y=y.min(1,T.I0.required)),i&&(y=y.max(i,T.I0.max)),y});return d[g]=l,d}const r=D.Vo(t=>t!==void 0?c.required===!0&&!a.isDraft?e.defined():e.nullable():c.required===!0?D.Ry().defined():D.Ry().nullable());return d[g]=r,d}if(c.type==="dynamiczone"){let e=D.IX().of(D.Vo(({__component:i})=>J(u[i],{components:u},{...a,isFromComponent:!0})));const{max:r,min:t}=c;t?c.required?e=e.test("min",T.I0.min,i=>a.isCreatingEntry?i&&i.length>=t:i===void 0?!0:i!==null&&i.length>=t).test("required",T.I0.required,i=>a.isCreatingEntry?i!==null||i!==void 0:i===void 0?!0:i!==null):e=e.notEmptyMin(t):c.required&&!a.isDraft&&(e=e.test("required",T.I0.required,i=>a.isCreatingEntry?i!==null||i!==void 0:i===void 0?!0:i!==null)),r&&(e=e.max(r,T.I0.max)),d[g]=e}return d},{}))},fe=(s,u,a)=>{let o=D.nK();return["string","uid","text","richtext","email","password","enumeration"].includes(s)&&(o=D.Z_()),s==="json"&&(o=D.nK(T.I0.json).test("isJSON",T.I0.json,d=>{if(!d||!d.length)return!0;try{return JSON.parse(d),!0}catch{return!1}}).nullable().test("required",T.I0.required,d=>!(u.required&&(!d||!d.length)))),s==="email"&&(o=o.email(T.I0.email)),["number","integer","float","decimal"].includes(s)&&(o=D.Rx().transform(d=>Q()(d)?void 0:d).typeError()),s==="biginteger"&&(o=D.Z_().matches(/^-?\d*$/)),["date","datetime"].includes(s)&&(o=D.hT()),Object.keys(u).forEach(d=>{const g=u[d];if(g||!le()(g)&&Number.isInteger(Math.floor(g))||g===0)switch(d){case"required":{a.isDraft||(s==="password"&&a.isCreatingEntry&&(o=o.required(T.I0.required)),s!=="password"&&(a.isCreatingEntry?o=o.required(T.I0.required):o=o.test("required",T.I0.required,c=>c===void 0&&!a.isFromComponent?!0:(0,re.Z)(s)?c===0?!0:!!c:s==="boolean"?c!=null:s==="date"||s==="datetime"?typeof c=="string"?!X()(c):!X()(c?.toString()):!X()(c))));break}case"max":{s==="biginteger"?o=o.isInferior(T.I0.max,g):o=o.max(g,T.I0.max);break}case"maxLength":o=o.max(g,T.I0.maxLength);break;case"min":{s==="biginteger"?o=o.isSuperior(T.I0.min,g):o=o.min(g,T.I0.min);break}case"minLength":{a.isDraft||(o=o.min(g,T.I0.minLength));break}case"regex":o=o.matches(new RegExp(g),{message:T.I0.regex,excludeEmptyString:!u.required});break;case"lowercase":["text","textarea","email","string"].includes(s)&&(o=o.strict().lowercase());break;case"uppercase":["text","textarea","email","string"].includes(s)&&(o=o.strict().uppercase());break;case"positive":(0,re.Z)(s)&&(o=o.positive());break;case"negative":(0,re.Z)(s)&&(o=o.negative());break;default:o=o.nullable()}}),o};var me=J},73347:function(W,v,n){n.d(v,{Z:function(){return m}});function m(E){return["integer","biginteger","decimal","float","number"].includes(E)}}}]);
