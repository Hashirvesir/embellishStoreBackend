"use strict";(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[8418],{61780:function(S,y,t){t.r(y),t.d(y,{default:function(){return ie}});var e=t(32735),o=t(94638),M=t(27649),T=t(82055),j=t(17e3),a=t(19565),s=t(67879),g=t(20108),v=t(19108),n=t(55733),L=t(85025),P=t(55225),l=t(31600),r=t(15335),i=t(5803),m=t(33475),c=t(11406),f=t(41415),I=t(26858),Z=t(51654),U=t(92802),A=t(60216),u=t.n(A),C=t(24346),w=C.Ry().shape({options:C.Ry().shape({from:C.Ry().shape({name:C.Z_().required(a.I0.required),email:C.Z_().email(a.I0.email).required(a.I0.required)}).required(),response_email:C.Z_().email(a.I0.email),object:C.Z_().required(a.I0.required),message:C.Z_().required(a.I0.required)}).required(a.I0.required)});const $=({template:d,onToggle:x,onSubmit:p})=>{const{formatMessage:h}=(0,s.Z)();return e.createElement(L.P,{onClose:x,labelledBy:`${h({id:(0,n.OB)("PopUpForm.header.edit.email-templates"),defaultMessage:"Edit email template"})}, ${h({id:(0,n.OB)(d.display),defaultMessage:d.display})}`},e.createElement(P.x,null,e.createElement(I.O,{label:`${h({id:(0,n.OB)("PopUpForm.header.edit.email-templates"),defaultMessage:"Edit email template"})}, ${h({id:(0,n.OB)(d.display),defaultMessage:d.display})}`},e.createElement(Z.$,null,h({id:(0,n.OB)("PopUpForm.header.edit.email-templates"),defaultMessage:"Edit email template"})),e.createElement(Z.$,{isCurrent:!0},h({id:(0,n.OB)(d.display),defaultMessage:d.display})))),e.createElement(U.J9,{onSubmit:p,initialValues:d,validateOnChange:!1,validationSchema:w,enableReinitialize:!0},({errors:O,values:b,handleChange:R,isSubmitting:H})=>e.createElement(a.l0,null,e.createElement(l.f,null,e.createElement(r.r,{gap:5},e.createElement(i.P,{col:6,s:12},e.createElement(a.jm,{intlLabel:{id:(0,n.OB)("PopUpForm.Email.options.from.name.label"),defaultMessage:"Shipper name"},name:"options.from.name",onChange:R,value:b.options.from.name,error:O?.options?.from?.name,type:"text"})),e.createElement(i.P,{col:6,s:12},e.createElement(a.jm,{intlLabel:{id:(0,n.OB)("PopUpForm.Email.options.from.email.label"),defaultMessage:"Shipper email"},name:"options.from.email",onChange:R,value:b.options.from.email,error:O?.options?.from?.email,type:"text"})),e.createElement(i.P,{col:6,s:12},e.createElement(a.jm,{intlLabel:{id:(0,n.OB)("PopUpForm.Email.options.response_email.label"),defaultMessage:"Response email"},name:"options.response_email",onChange:R,value:b.options.response_email,error:O?.options?.response_email,type:"text"})),e.createElement(i.P,{col:6,s:12},e.createElement(a.jm,{intlLabel:{id:(0,n.OB)("PopUpForm.Email.options.object.label"),defaultMessage:"Subject"},name:"options.object",onChange:R,value:b.options.object,error:O?.options?.object,type:"text"})),e.createElement(i.P,{col:12,s:12},e.createElement(m.g,{label:h({id:(0,n.OB)("PopUpForm.Email.options.message.label"),defaultMessage:"Message"}),id:"options.message",onChange:R,value:b.options.message,error:O?.options?.message&&h({id:O.options.message,defaultMessage:O.options.message})})))),e.createElement(c.m,{startActions:e.createElement(f.z,{onClick:x,variant:"tertiary"},"Cancel"),endActions:e.createElement(f.z,{loading:H,type:"submit"},"Finish")}))))};$.propTypes={template:u().shape({display:u().string,icon:u().string,options:u().shape({from:u().shape({name:u().string,email:u().string}),message:u().string,object:u().string,response_email:u().string})}).isRequired,onSubmit:u().func.isRequired,onToggle:u().func.isRequired};var k=$,q=t(56755),_=t(33827),F=t(94547),B=t(19786),N=t(3685),D=t(49372),ee=t(35658),z=t(99140),K=t(50563),te=t(44647),G=t(68625),ae=t(66456);const J=({canUpdate:d,onEditClick:x})=>{const{formatMessage:p}=(0,s.Z)();return e.createElement(q.i,{colCount:3,rowCount:3},e.createElement(_.h,null,e.createElement(F.Tr,null,e.createElement(B.Th,{width:"1%"},e.createElement(N.T,null,p({id:(0,n.OB)("Email.template.table.icon.label"),defaultMessage:"icon"}))),e.createElement(B.Th,null,e.createElement(D.Z,{variant:"sigma",textColor:"neutral600"},p({id:(0,n.OB)("Email.template.table.name.label"),defaultMessage:"name"}))),e.createElement(B.Th,{width:"1%"},e.createElement(N.T,null,p({id:(0,n.OB)("Email.template.table.action.label"),defaultMessage:"action"}))))),e.createElement(ee.p,null,e.createElement(F.Tr,{...(0,a.X7)({fn:()=>x("reset_password")})},e.createElement(B.Td,null,e.createElement(z.J,null,e.createElement(te.Z,{"aria-label":p({id:"global.reset-password",defaultMessage:"Reset password"})}))),e.createElement(B.Td,null,e.createElement(D.Z,null,p({id:"global.reset-password",defaultMessage:"Reset password"}))),e.createElement(B.Td,{...a.UW},e.createElement(K.h,{onClick:()=>x("reset_password"),label:p({id:(0,n.OB)("Email.template.form.edit.label"),defaultMessage:"Edit a template"}),noBorder:!0,icon:d&&e.createElement(G.Z,null)}))),e.createElement(F.Tr,{...(0,a.X7)({fn:()=>x("email_confirmation")})},e.createElement(B.Td,null,e.createElement(z.J,null,e.createElement(ae.Z,{"aria-label":p({id:(0,n.OB)("Email.template.email_confirmation"),defaultMessage:"Email address confirmation"})}))),e.createElement(B.Td,null,e.createElement(D.Z,null,p({id:(0,n.OB)("Email.template.email_confirmation"),defaultMessage:"Email address confirmation"}))),e.createElement(B.Td,{...a.UW},e.createElement(K.h,{onClick:()=>x("email_confirmation"),label:p({id:(0,n.OB)("Email.template.form.edit.label"),defaultMessage:"Edit a template"}),noBorder:!0,icon:d&&e.createElement(G.Z,null)})))))};J.propTypes={canUpdate:u().bool.isRequired,onEditClick:u().func.isRequired};var ne=J;const le=()=>e.createElement(a.O4,{permissions:v._.readEmailTemplates},e.createElement(se,null)),se=()=>{const{formatMessage:d}=(0,s.Z)(),{trackUsage:x}=(0,a.rS)(),{notifyStatus:p}=(0,o.G)(),h=(0,a.lm)(),{lockApp:O,unlockApp:b}=(0,a.o1)(),R=(0,g.useQueryClient)(),{get:H,put:oe}=(0,a.kY)(),{formatAPIError:Q}=(0,a.So)();(0,a.go)();const[re,me]=e.useState(!1),[X,de]=e.useState(null),{isLoading:ce,allowedActions:{canUpdate:ue}}=(0,a.ss)({update:v._.updateEmailTemplates}),{isLoading:pe,data:V}=(0,g.useQuery)(["users-permissions","email-templates"],async()=>{const{data:E}=await H("/users-permissions/email-templates");return E},{onSuccess(){p(d({id:(0,n.OB)("Email.template.data.loaded"),defaultMessage:"Email templates has been loaded"}))},onError(E){h({type:"warning",message:Q(E)})}}),Ee=ce||pe,W=()=>{me(E=>!E)},ge=E=>{de(E),W()},Y=(0,g.useMutation)(E=>oe("/users-permissions/email-templates",{"email-templates":E}),{async onSuccess(){await R.invalidateQueries(["users-permissions","email-templates"]),h({type:"success",message:{id:"notification.success.saved",defaultMessage:"Saved"}}),x("didEditEmailTemplates"),b(),W()},onError(E){h({type:"warning",message:Q(E)}),b()},refetchActive:!0}),fe=E=>{O(),x("willEditEmailTemplates");const he={...V,[X]:E};Y.mutate(he)};return Ee?e.createElement(M.o,{"aria-busy":"true"},e.createElement(a.SL,{name:d({id:(0,n.OB)("HeaderNav.link.emailTemplates"),defaultMessage:"Email templates"})}),e.createElement(T.T,{title:d({id:(0,n.OB)("HeaderNav.link.emailTemplates"),defaultMessage:"Email templates"})}),e.createElement(j.D,null,e.createElement(a.dO,null))):e.createElement(M.o,{"aria-busy":Y.isLoading},e.createElement(a.SL,{name:d({id:(0,n.OB)("HeaderNav.link.emailTemplates"),defaultMessage:"Email templates"})}),e.createElement(T.T,{title:d({id:(0,n.OB)("HeaderNav.link.emailTemplates"),defaultMessage:"Email templates"})}),e.createElement(j.D,null,e.createElement(ne,{onEditClick:ge,canUpdate:ue}),re&&e.createElement(k,{template:V[X],onToggle:W,onSubmit:fe})))};var ie=le},55733:function(S,y,t){t.d(y,{YX:function(){return T},OB:function(){return j.Z}});var e=t(86834),o=t.n(e),T=a=>Object.keys(a).reduce((s,g)=>{const v=a[g].controllers,n=Object.keys(v).reduce((L,P)=>(o()(v[P])||(L[P]=v[P]),L),{});return o()(n)||(s[g]={controllers:n}),s},{}),j=t(48395)},17e3:function(S,y,t){t.d(y,{D:function(){return M}});var e=t(74512),o=t(72850);const M=({children:T})=>(0,e.jsx)(o.x,{paddingLeft:10,paddingRight:10,children:T})},82055:function(S,y,t){t.d(y,{T:function(){return n}});var e=t(74512),o=t(32735),M=t(8471);const T=l=>{const r=(0,o.useRef)(null),[i,m]=(0,o.useState)(!0),c=([f])=>{m(f.isIntersecting)};return(0,o.useEffect)(()=>{const f=r.current,I=new IntersectionObserver(c,l);return f&&I.observe(r.current),()=>{f&&I.disconnect()}},[r,l]),[r,i]};var j=t(81957);const a=(l,r)=>{const i=(0,j.W)(r);(0,o.useLayoutEffect)(()=>{const m=new ResizeObserver(i);return Array.isArray(l)?l.forEach(c=>{c.current&&m.observe(c.current)}):l.current&&m.observe(l.current),()=>{m.disconnect()}},[l,i])};var s=t(72850),g=t(87933),v=t(49372);const n=l=>{const r=(0,o.useRef)(null),[i,m]=(0,o.useState)(null),[c,f]=T({root:null,rootMargin:"0px",threshold:0});return a(c,()=>{c.current&&m(c.current.getBoundingClientRect())}),(0,o.useEffect)(()=>{r.current&&m(r.current.getBoundingClientRect())},[r]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{style:{height:i?.height},ref:c,children:f&&(0,e.jsx)(P,{ref:r,...l})}),!f&&(0,e.jsx)(P,{...l,sticky:!0,width:i?.width})]})};n.displayName="HeaderLayout";const L=(0,M.ZP)(s.x)`
  width: ${({width:l})=>l?`${l/16}rem`:void 0};
  z-index: ${({theme:l})=>l.zIndices[1]};
`,P=o.forwardRef(({navigationAction:l,primaryAction:r,secondaryAction:i,subtitle:m,title:c,sticky:f,width:I,...Z},U)=>{const A=typeof m=="string";return f?(0,e.jsx)(L,{paddingLeft:6,paddingRight:6,paddingTop:3,paddingBottom:3,position:"fixed",top:0,right:0,background:"neutral0",shadow:"tableShadow",width:I,"data-strapi-header-sticky":!0,children:(0,e.jsxs)(g.k,{justifyContent:"space-between",children:[(0,e.jsxs)(g.k,{children:[l&&(0,e.jsx)(s.x,{paddingRight:3,children:l}),(0,e.jsxs)(s.x,{children:[(0,e.jsx)(v.Z,{variant:"beta",as:"h1",...Z,children:c}),A?(0,e.jsx)(v.Z,{variant:"pi",textColor:"neutral600",children:m}):m]}),i?(0,e.jsx)(s.x,{paddingLeft:4,children:i}):null]}),(0,e.jsx)(g.k,{children:r?(0,e.jsx)(s.x,{paddingLeft:2,children:r}):void 0})]})}):(0,e.jsxs)(s.x,{ref:U,paddingLeft:10,paddingRight:10,paddingBottom:8,paddingTop:l?6:8,background:"neutral100","data-strapi-header":!0,children:[l?(0,e.jsx)(s.x,{paddingBottom:2,children:l}):null,(0,e.jsxs)(g.k,{justifyContent:"space-between",children:[(0,e.jsxs)(g.k,{minWidth:0,children:[(0,e.jsx)(v.Z,{as:"h1",variant:"alpha",...Z,children:c}),i?(0,e.jsx)(s.x,{paddingLeft:4,children:i}):null]}),r]}),A?(0,e.jsx)(v.Z,{variant:"epsilon",textColor:"neutral600",as:"p",children:m}):m]})})},27649:function(S,y,t){t.d(y,{o:function(){return j}});var e=t(74512),o=t(8471),M=t(72850);const T=(0,o.ZP)(M.x)`
  // To prevent global outline on focus visible to force an outline when Main is focused
  &:focus-visible {
    outline: none;
  }
`,j=({labelledBy:a="main-content-title",...s})=>(0,e.jsx)(T,{"aria-labelledby":a,as:"main",id:"main-content",tabIndex:-1,...s})}}]);
