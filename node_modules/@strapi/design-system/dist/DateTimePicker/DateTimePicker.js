import { jsx as o, jsxs as F } from "react/jsx-runtime";
import v, { forwardRef as G } from "react";
import { getLocalTimeZone as P, parseAbsoluteToLocal as J, toCalendarDateTime as K } from "@internationalized/date";
import $ from "styled-components";
import { DatePickerInput as Q } from "../DatePicker/DatePicker.js";
import { useDesignSystem as W } from "../DesignSystemProvider.js";
import { once as X } from "../helpers/deprecations.js";
import { useComposedRefs as Y } from "../hooks/useComposeRefs.js";
import { useControllableState as ee } from "../hooks/useControllableState.js";
import { useDateFormatter as te } from "../hooks/useDateFormatter.js";
import { useId as b } from "../hooks/useId.js";
import { TimePickerInput as re } from "../TimePicker/TimePicker.js";
import { Field as oe } from "../Field/Field.js";
import { Flex as L } from "../Flex/Flex.js";
import { FieldLabel as ie } from "../Field/FieldLabel.js";
import { VisuallyHidden as S } from "../VisuallyHidden/VisuallyHidden.js";
import { FieldHint as ne } from "../Field/FieldHint.js";
import { FieldError as ae } from "../Field/FieldError.js";
const Se = G(({
  /**
   * @preserve
   * @deprecated This is no longer used.
   */
  ariaLabel: n,
  clearLabel: d = "clear",
  dateLabel: p = "Choose date",
  timeLabel: a = "Choose time",
  disabled: s = !1,
  error: h,
  hint: R,
  id: V,
  label: _,
  labelAction: N,
  onChange: I,
  onClear: c,
  name: j,
  required: D = !1,
  /**
   * @preserve
   * @deprecated This is no longer used.
   */
  selectButtonTitle: de,
  size: C = "M",
  step: z,
  value: g,
  initialDate: k,
  ...B
}, E) => {
  const w = v.useRef(null), [t, f] = ee({
    defaultProp: k ? m(k, !1) : void 0,
    prop: g ? m(g, !1) : g ?? void 0,
    onChange(e) {
      I && I(e?.toDate(P()));
    }
  }), H = W("DateTimePicker"), O = te(H.locale, {
    hour: "2-digit",
    minute: "2-digit",
    hour12: !1
  }), l = t ? O.format(t.toDate(P())) : "", U = (e) => {
    let r = e ? m(e) : void 0;
    if (!(r && t && r.compare(t) === 0)) {
      if (l && r) {
        const [u, T] = l.split(":");
        r = r.set({ hour: parseInt(u, 10), minute: parseInt(T, 10) });
      }
      f(r);
    }
  }, q = (e) => {
    if (!e)
      return;
    const [r, u] = e.split(":"), T = t ? t.set({ hour: parseInt(r, 10), minute: parseInt(u, 10) }) : m(/* @__PURE__ */ new Date()).set({
      hour: parseInt(r, 10),
      minute: parseInt(u, 10)
    });
    f(T);
  }, A = (e) => {
    f(void 0), c && c(e);
  }, M = () => {
    const e = t ? t.set({ hour: 0, minute: 0 }) : m(/* @__PURE__ */ new Date());
    f(e);
  }, i = b(V), x = b(), y = b(), Z = Y(w, E);
  return o(oe, { name: j, as: "fieldset", id: i, "aria-labelledby": i, hint: R, error: h, required: D, children: F(L, { as: "span", direction: "column", alignItems: "stretch", gap: 1, children: [o(ie, { onClick: () => {
    w.current.focus();
  }, as: "legend", id: i, action: N, children: _ }), F(L, { flex: "1", gap: 1, children: [o(S, { as: "label", htmlFor: y, children: p }), o(le, { ...B, selectedDate: t?.toDate("UTC"), onChange: U, error: typeof h == "string", required: D, size: C, onClear: c ? A : void 0, clearLabel: `${d} date`, disabled: s, id: y, ref: Z, "aria-describedby": `${i}-hint ${i}-error` }), o(S, { as: "label", htmlFor: x, children: a }), o(me, { size: C, error: typeof h == "string", value: l, onChange: q, onClear: c && l !== void 0 && l !== "00:00" ? M : void 0, clearLabel: `${d} time`, required: D, disabled: s, step: z, id: x, "aria-describedby": `${i}-hint ${i}-error` })] }), o(ne, {}), o(ae, {})] }) });
}), se = X(console.warn), m = (n, d = !0) => {
  if (typeof n == "string") {
    se("It looks like you're passing a string as representation of a Date to the DatePicker. This is deprecated, look to passing a Date instead.");
    const s = Date.parse(n);
    Number.isNaN(s) ? n = /* @__PURE__ */ new Date() : n = new Date(s);
  }
  const p = n.toISOString();
  let a = J(p);
  return d && (a = a.set({ hour: 0, minute: 0 })), K(a);
}, le = $(Q)`
  flex: 1 1 70%;
  min-width: 120px;
`, me = $(re)`
  flex: 1 1 30%;
  min-width: 120px;
`;
export {
  Se as DateTimePicker,
  m as convertUTCDateToCalendarDateTime
};
